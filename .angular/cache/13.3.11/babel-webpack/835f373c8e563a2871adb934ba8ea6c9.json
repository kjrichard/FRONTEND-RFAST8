{"ast":null,"code":"import _classCallCheck from \"C:\\\\FRONTEND-RFAST8\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\FRONTEND-RFAST8\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { __decorate, __metadata } from \"tslib\";\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { UsuariosService } from './../../services/usuarios.service';\nimport { Component, ElementRef, ViewChild } from \"@angular/core\";\nimport Swal from 'sweetalert2';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { Router } from '@angular/router';\n\nvar UserComponent = /*#__PURE__*/function () {\n  function UserComponent(usuariosService, fb, modalService, router) {\n    _classCallCheck(this, UserComponent);\n\n    this.usuariosService = usuariosService;\n    this.fb = fb;\n    this.modalService = modalService;\n    this.router = router;\n    this.listaUsuarios = [];\n    this.listaPermisos = [];\n    this.usuarioFormulario = null;\n    this.usuarioFormularioActualizar = null;\n    this.listaPerfiles = [];\n    this.permisosSeleccionados = [];\n    this.permisos = [];\n    this.selectedValues = [];\n  }\n\n  _createClass(UserComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      this.obtenerUsuario();\n      this.obtenerPerfil();\n      this.usuarioFormulario = this.fb.group({\n        email: ['', [Validators.required, Validators.pattern('[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}')]],\n        nombres: ['', [Validators.required]],\n        apellidos: ['', [Validators.required]],\n        id_perfil: ['', [Validators.required]],\n        permisos: [[], [Validators.required]],\n        cedula: ['', [Validators.required, Validators.min(7)]]\n      });\n      this.usuarioFormularioActualizar = this.fb.group({\n        email: ['', [Validators.required, Validators.pattern('[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}')]],\n        nombres: ['', [Validators.required]],\n        apellidos: ['', [Validators.required]],\n        id_perfil: ['', [Validators.required]],\n        permisos: [[], [Validators.required]],\n        cedula: ['', [Validators.required, Validators.min(7)]],\n        id: ['']\n      });\n      this.obtenerPermisos();\n    }\n  }, {\n    key: \"onSelectMultiple\",\n    value: function onSelectMultiple(select) {\n      var selectedOptions = Array.from(select.selectedOptions);\n      this.selectedValues = selectedOptions.map(function (option) {\n        return Number(option.value);\n      });\n      console.log(this.selectedValues);\n    }\n  }, {\n    key: \"obtenerUsuario\",\n    value: function obtenerUsuario() {\n      var _this = this;\n\n      this.usuariosService.obtenerUsuario().subscribe(function (res) {\n        _this.listaUsuarios = res.data;\n      });\n    }\n  }, {\n    key: \"obtenerPerfil\",\n    value: function obtenerPerfil() {\n      var _this2 = this;\n\n      this.usuariosService.obtenerPerfil().subscribe(function (res) {\n        _this2.listaPerfiles = res.data;\n      });\n    }\n  }, {\n    key: \"obtenerPermisos\",\n    value: function obtenerPermisos() {\n      var _this3 = this;\n\n      this.usuariosService.obtenerPermisos().subscribe(function (res) {\n        _this3.listaPermisos = res.data;\n      });\n    }\n  }, {\n    key: \"opcionControl\",\n    value: function opcionControl(id) {\n      this.permisos.push(id);\n      this.usuarioFormulario.controls.permisos.setValue(this.permisos);\n    }\n  }, {\n    key: \"opcionControlActualizar\",\n    value: function opcionControlActualizar(id) {\n      this.permisos.push(id);\n      this.usuarioFormularioActualizar.controls.permisos.setValue(this.permisos);\n    }\n  }, {\n    key: \"crearUsuario\",\n    value: function crearUsuario() {\n      var _this4 = this;\n\n      var formularioValues = this.usuarioFormulario.value; // Ahora puedes enviar los valores a tu backend u otra l√≥gica de procesamiento\n\n      console.log(formularioValues);\n      this.usuariosService.crearUsuario(this.usuarioFormulario.value).subscribe(function (res) {\n        _this4.usuarioFormulario.reset();\n\n        _this4.obtenerUsuario();\n\n        Swal.fire({\n          position: 'center',\n          icon: 'success',\n          title: 'GUARDO OK',\n          text: res.message,\n          showConfirmButton: false,\n          timer: 3500\n        });\n      }, function (error) {\n        console.log(error);\n        Swal.fire({\n          position: 'center',\n          icon: 'error',\n          title: 'VERIFIQUE CONEXION: ',\n          text: error.error.message,\n          showConfirmButton: false,\n          timer: 3500\n        });\n      });\n    }\n  }, {\n    key: \"obtenerDatos\",\n    value: function obtenerDatos(table, basicModal) {\n      this.modalService.open(basicModal);\n      this.usuarioFormularioActualizar.controls['email'].setValue(table.email);\n      this.usuarioFormularioActualizar.controls['nombres'].setValue(table.nombres);\n      this.usuarioFormularioActualizar.controls['apellidos'].setValue(table.apellidos);\n      this.usuarioFormularioActualizar.controls['id_perfil'].setValue(table.id_perfil);\n      this.usuarioFormularioActualizar.controls['cedula'].setValue(table.cedula);\n      this.usuarioFormularioActualizar.controls['id'].setValue(table.id);\n      this.usuarioFormularioActualizar.controls['permisos'].setValue([]);\n      console.log(this.usuarioFormularioActualizar.value);\n      this.id_usuario = this.usuarioFormularioActualizar.get('id').value;\n    }\n  }, {\n    key: \"actualizarUsuario\",\n    value: function actualizarUsuario() {\n      var _this5 = this;\n\n      this.usuariosService.actualizarUsuario(this.usuarioFormularioActualizar.value, this.id_usuario).subscribe(function (res) {\n        _this5.permisos = [];\n\n        _this5.usuarioFormularioActualizar.controls['permisos'].setValue([]);\n\n        _this5.listaPermisos = [];\n\n        _this5.obtenerUsuario();\n\n        _this5.obtenerPermisos();\n\n        _this5.reloadPage();\n\n        Swal.fire({\n          position: 'center',\n          icon: 'success',\n          title: 'ACTUALIZADO OK',\n          text: res.msg,\n          showConfirmButton: false,\n          timer: 3500\n        });\n      }, function (error) {\n        console.log(error);\n        Swal.fire({\n          position: 'center',\n          icon: 'error',\n          title: 'VERIFIQUE CONEXION: ',\n          text: error.error.message,\n          showConfirmButton: false,\n          timer: 3500\n        });\n      });\n    }\n  }, {\n    key: \"toggleEstado\",\n    value: function toggleEstado(usuario) {\n      var _this6 = this;\n\n      var estado;\n\n      if (usuario.estado === null || usuario.estado === false) {\n        estado = true;\n      } else {\n        estado = false;\n      }\n\n      this.usuariosService.actualizarUsuario({\n        estado: estado\n      }, usuario.id).subscribe(function (res) {\n        Swal.fire({\n          position: 'center',\n          icon: 'success',\n          title: 'Estado actualizado',\n          text: res.msg,\n          showConfirmButton: false,\n          timer: 3500\n        });\n\n        _this6.obtenerUsuario();\n      }, function (error) {\n        console.log(error);\n        Swal.fire({\n          position: 'center',\n          icon: 'error',\n          title: 'Error al actualizar el estado',\n          text: error.error.message,\n          showConfirmButton: false,\n          timer: 3500\n        });\n      });\n    }\n  }, {\n    key: \"reloadPage\",\n    value: function reloadPage() {\n      var _this7 = this;\n\n      var currentUrl = this.router.url;\n      this.router.navigateByUrl('/', {\n        skipLocationChange: true\n      }).then(function () {\n        _this7.router.navigate([currentUrl]);\n      });\n    }\n  }]);\n\n  return UserComponent;\n}();\n\n__decorate([ViewChild('addEmployeeModal'), __metadata(\"design:type\", ElementRef)], UserComponent.prototype, \"modalElement\", void 0);\n\nUserComponent = __decorate([Component({\n  selector: \"app-user\",\n  templateUrl: \"user.component.html\"\n}), __metadata(\"design:paramtypes\", [UsuariosService, FormBuilder, NgbModal, Router])], UserComponent);\nexport { UserComponent };","map":null,"metadata":{},"sourceType":"module"}